name: Copilot Setup Steps
"on":
  pull_request:
    paths:
    - .github/workflows/copilot-setup-steps.yml
  push:
    paths:
    - .github/workflows/copilot-setup-steps.yml
  workflow_dispatch: null
jobs:
  copilot-setup-steps:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
    - name: Install gh-aw extension
      run: curl -fsSL https://raw.githubusercontent.com/github/gh-aw/refs/heads/main/install-gh-aw.sh | bash
    - name: Checkout code
      uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd  # v6.0.2
    - name: Set up Node.js
      uses: actions/setup-node@6044e13b5dc448c55e2357c09f80417699197238  # v6.2.0
      with:
        cache: npm
        cache-dependency-path: actions/setup/js/package-lock.json
        node-version: "24"
    - name: Set up Go
      uses: actions/setup-go@7a3fe6cf4cb3a834922a1244abfce67bcef6a0c5  # v6.2.0
      with:
        cache: true
        go-version-file: go.mod
    - name: Install JavaScript dependencies
      run: cd actions/setup/js && npm ci
    - name: Install development dependencies
      run: make deps-dev
    - name: Build code
      run: make build
    - name: Recompile workflows
      run: make recompile
      env:
        GH_TOKEN: ${{ github.token }}
    - name: Install UV (Python package manager)
      run: curl -LsSf https://astral.sh/uv/install.sh | sh
    - name: Install Go language server (gopls)
      run: go install golang.org/x/tools/gopls@latest
    - name: Install TypeScript language server
      run: npm install -g typescript-language-server typescript
